---
author: 
  name: 木子识时务
  link: https://github.com/sbwcwso
editLink: true
title: 高速缓冲存储器
date: 2021-08-01 03:03:18
permalink: /pages/6b8ad2/
categories: 
  - 计算机组成原理
tags: 
  - null
---

# 高速缓冲存储器


```markmap
- [高速缓冲存储器](#高速缓冲存储器)
  - [概述](#概述)
    - [Cache 的工作原理](#cache-的工作原理)
    - [Cache 的基本结构](#cache-的基本结构)
    - [Cache 的读写操作](#cache-的读写操作)
      - [Cache 读操作](#cache-读操作)
      - [Cache 写操作](#cache-写操作)
    - [Cache 的改进](#cache-的改进)
  - [Cache 主存的地址映射  🌟](#cache-主存的地址映射--)
    - [直接映射](#直接映射)
    - [全相关映射](#全相关映射)
    - [组相联映射](#组相联映射)
  - [替换算法](#替换算法)
    - [先进先出(FIFO)算法](#先进先出fifo算法)
    - [近斯最少使用(LRU)算法](#近斯最少使用lru算法)
```

## 概述


* 避免 CPU "空等" 现象

![20210825210323-2021-08-25-21-03-23](https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210825210323-2021-08-25-21-03-23.png)

* 程序访问的局部性原理 🌟

### Cache 的工作原理

* 主存的缓存的编址
  * 标记: 主存块和 Cache 块的对应关系
  * ![20210825210913-2021-08-25-21-09-13](https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210825210913-2021-08-25-21-09-13.png)

* 命中与未命中
* Cache 的命中率
  * 块长过小，没有充分利用程序访问的局部性原理
* Cache -- 主存系统的效率
  * $$e = \frac{\text{访问 Cache 的时间}}{\text{平均访问时音}} \times 100\%$$

### Cache 的基本结构

* 内存放到 Cache 中，映像
* 变换，将主存的地址转换为 Cache 的地址

![20210901105755-2021-09-01-10-57-55](https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210901105755-2021-09-01-10-57-55.png)

* 先把数据送到 CPU 中，同时写入 Cache 中
* 替换算法

### Cache 的读写操作

#### Cache 读操作

![20210901110018-2021-09-01-11-00-18](https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210901110018-2021-09-01-11-00-18.png)

#### Cache 写操作

* Cache 和主存的一致性问题
:::note 写直达法(写通过)
* 写操作时数据既写入Cache又写入主存
* 写操作时间就是访问主存的时间
* Cache块退出时，不需要对主存执行写操作，更新策略比较容易实现
:::tip 缺点
* 可能对同一块内存进行频繁的写入
* 求累加和
:::
:::note 写回法
* 写操作时只把数据写入 Cache 而不写入主存
  * 当 Cache 数据被替换出去时才写回主存
* 写操作时间就是访问 Cache 的时间
* Cache块退出时，被替换的块需写回主存
  * 增加了Cache 的复杂性
:::

### Cache 的改进

* 增加 Cache 的级数
  * 片载（片内）Cache
    * 多核共用 Cache, 每个核有自己独特的 Cache
  * 片外 Cache
* 统一缓存和分立缓存
  * 指令 Cache 和数据 Cache
    * 与指令执行的控制方式，以及是否流水有关

## Cache 主存的地址映射  🌟

### 直接映射

* 每个缓存块 $i$ 可以和若干个主存块对应
* 每个主存块 $j$ 只能和一个缓存块对应

* 利用率较低，冲突的可能性比较大

### 全相关映射

* Cache 利用率较高
* 访问电路较复杂，参加比较的位数较长，速度较慢

* 主存中的任一块可以映射到缓存中的任一块

### 组相联映射


靠近 CPU 的缓存层次采用直接映射

## 替换算法

### 先进先出(FIFO)算法

### 近斯最少使用(LRU)算法


