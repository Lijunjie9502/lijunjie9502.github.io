---
author: 
  name: 木子识时务
  link: https://github.com/sbwcwso
editLink: true
title: 程序中断方式
date: 2021-09-04 09:35:27
permalink: /pages/e7ccbc/
categories: 
  - 计算机组成原理
tags: 
  - 
---

# 程序中断方式

```markmap
- [程序中断方式](#程序中断方式)
  - [中断的概念](#中断的概念)
  - [I/O 中断的产生](#io-中断的产生)
  - [程序中断方式的接口电路](#程序中断方式的接口电路)
  - [I/O 中断的处理过程](#io-中断的处理过程)
  - [中断服务程序流程](#中断服务程序流程)
```

## 中断的概念

![20210904093655-2021-09-04-09-36-55](https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210904093655-2021-09-04-09-36-55.png)

## I/O 中断的产生

:::note 以打印机为例

![20210904093952-2021-09-04-09-39-52](https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210904093952-2021-09-04-09-39-52.png)

:::tip CPU 与打印机部分并行工作
:::

## 程序中断方式的接口电路

::: note 配置中断请求触发器和中断屏蔽触发器
* 进行数据传输时需要屏蔽中断
:::

::: note 排队器
* 优先级
* 硬件实现
  * ![20210914093530-2021-09-14-09-35-30](https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210914093530-2021-09-14-09-35-30.png)
  * ![20210914093817-2021-09-14-09-38-17](https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210914093817-2021-09-14-09-38-17.png)
* 软件实现
:::

::: note 中断向量地址形成部件
* 中断向量可理解为中断服务程序的入口地址
  * 由软件产生
    * 第八章
  * 硬件向量法
    * 由**硬件**产生**向量地址**，再由**向量地址**找到**入口地址**
    * ![20210914094433-2021-09-14-09-44-33](https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210914094433-2021-09-14-09-44-33.png)
      * P119 页有设备编码器的具体结构
    * ![20210914094449-2021-09-14-09-44-49](https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210914094449-2021-09-14-09-44-49.png)
:::

:::note 程序中断方式接口电路的基本组成
![20210914095222-2021-09-14-09-52-22](https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210914095222-2021-09-14-09-52-22.png)
:::

## I/O 中断的处理过程

::: note CPU 响应中断的条件和时间
* 条件
  * 允许中断触发器 EINT = 1
* 时间
  * 当 D = 1（随机）且 MASK = 0 时
  * **在每条指令执行阶段的结束前**, **CPU**发**中断查询信号**（将 INTR 置“1”）
:::

::: note I/O 中断的处理过程
![20210914100034-2021-09-14-10-00-34](https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210914100034-2021-09-14-10-00-34.png)
:::

## 中断服务程序流程

:::note 中断服务程序的流程
* 保护现场
  * 程序断点的保护
    * 中断隐指令
    * 由硬件完成
  * 寄存器内容的保护
    * 进栈指令
      * 不一定非要使用进栈指令
* 中断服务
* 恢复现场
  * 出栈指令
    * 使用进栈指令时采取的恢复措施
* 中断返回
  * 中断返回指令
:::

:::note 单重中断和多重中断
* 单重中断
  * 不允许中断现行的中断服务程序
  :::details 单重中断流程示意图
  ![20210914101134-2021-09-14-10-11-34](https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210914101134-2021-09-14-10-11-34.png)
* 多重中断
  * 允许级别更高的中断源中断现行的中断服务程序
  ::: details 多重中断流程示意图
  ![20210914101202-2021-09-14-10-12-02](https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210914101202-2021-09-14-10-12-02.png)
  * 开中断的位置和单重中断不一样
:::

:::note 主程序和中断服务程序抢占 CPU 示意图
![20210914102849-2021-09-14-10-28-49](https://cdn.jsdelivr.net/gh/sbwcwso/PicBed@master/20210914102849-2021-09-14-10-28-49.png)
* 宏观上 CPU 和 I/O 并行工作
* 微观上 CPU 中断现行程序为 I/O 服务
:::


